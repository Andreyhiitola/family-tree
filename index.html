<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –¥—Ä–µ–≤–æ —Å–µ–º—å–∏</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üå≥ –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—à–µ–π —Å–µ–º—å–∏ –≤ –ª–∏—Ü–∞—Ö</h1>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="showAddPersonModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="showGallery()">üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è</button>
                <button class="btn btn-secondary" onclick="showTimeline()">üìÖ –°–æ–±—ã—Ç–∏—è</button>
                <button class="btn btn-secondary" onclick="showStats()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button class="btn btn-secondary" onclick="showMap()">üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>
                <button class="btn btn-secondary" onclick="toggleTheme()">üé® –¢–µ–º–∞</button>
                <button class="btn btn-accent" onclick="exportToPDF()">üìÑ PDF</button>
                <button class="btn btn-accent" onclick="exportToExcel()">üìä Excel</button>
                <button class="btn btn-accent" onclick="exportData()">üíæ JSON</button>
                <button class="btn btn-accent" onclick="importData()">üì• –ò–º–ø–æ—Ä—Ç JSON</button>
                <button class="btn btn-accent" onclick="importExcel()">üì• –ò–º–ø–æ—Ä—Ç Excel</button>
                <button class="btn btn-accent" onclick="downloadTemplate()">üìã –®–∞–±–ª–æ–Ω Excel</button>
            </div>
        </header>

        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." oninput="searchPerson()">
            <button class="btn-clear" onclick="clearSearch()">‚úï</button>
        </div>

        <div id="familyTree"></div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–°–ú–û–¢–†–ê -->
    <div id="viewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="viewModalName"></h2>
                <div class="modal-buttons">
                    <button class="btn btn-primary" onclick="editCurrentPerson()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="btn btn-danger" onclick="deletePerson()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    <button class="btn btn-secondary" onclick="closeModal('viewModal')">‚úï</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="photoCarousel" class="photo-carousel">
                    <button class="carousel-btn prev" onclick="prevPhoto()">‚ùÆ</button>
                    <img id="viewModalPhoto" class="modal-photo">
                    <button class="carousel-btn next" onclick="nextPhoto()">‚ùØ</button>
                </div>
                <div id="viewModalInfo"></div>
                <div id="mediaSection"></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="editModalTitle">–î–æ–±–∞–≤–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞</h2>
                <button class="btn btn-secondary close-btn" onclick="closeModal('editModal')">‚úï</button>
            </div>
            <form id="personForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>–ò–º—è *</label>
                        <input type="text" id="personName" required>
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–ª</label>
                        <select id="personGender">
                            <option value="">–ù–µ —É–∫–∞–∑–∞–Ω</option>
                            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (–ì–ì–ì–ì-–ú–ú-–î–î)</label>
                        <input type="date" id="personBirthDate">
                    </div>
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Å–º–µ—Ä—Ç–∏ (–ì–ì–ì–ì-–ú–ú-–î–î)</label>
                        <input type="date" id="personDeathDate">
                    </div>
                    <div class="form-group">
                        <label>–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                        <input type="text" id="personBirthPlace">
                    </div>
                    <div class="form-group">
                        <label>–†–æ–¥–∏—Ç–µ–ª—å</label>
                        <select id="personParent"></select>
                    </div>
                    <div class="form-group">
                        <label>–°—É–ø—Ä—É–≥(–∞)</label>
                        <select id="personSpouse"></select>
                    </div>
                </div>
                <div class="form-group">
                    <label>–ë–∏–æ–≥—Ä–∞—Ñ–∏—è</label>
                    <textarea id="personBio" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>–í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ, —Ñ–æ—Ä–º–∞—Ç: –ì–ì–ì–ì - –æ–ø–∏—Å–∞–Ω–∏–µ)</label>
                    <textarea id="personEvents" rows="4" placeholder="1920 - –†–æ–¥–∏–ª—Å—è –≤ –¥–µ—Ä–µ–≤–Ω–µ
1945 - –í–µ—Ä–Ω—É–ª—Å—è —Å –≤–æ–π–Ω—ã"></textarea>
                </div>
                <div class="form-group">
                    <label>YouTube –≤–∏–¥–µ–æ (—Å—Å—ã–ª–∫–∞)</label>
                    <input type="url" id="personVideo" placeholder="https://youtube.com/watch?v=...">
                </div>
                <div class="form-group">
                    <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</label>
                    <input type="file" id="photoInput" accept="image/*" multiple>
                    <div id="photosPreview"></div>
                </div>
                <div class="form-group">
                    <label>–ê—É–¥–∏–æ–∑–∞–ø–∏—Å—å</label>
                    <audio id="audioPreview" controls style="display: none;"></audio>
                    <br>
                    <button type="button" id="recordBtn" class="btn btn-accent" onclick="toggleRecording()">üé§ –ó–∞–ø–∏—Å–∞—Ç—å</button>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editModal')">‚ùå –û—Ç–º–µ–Ω–∞</button>
                    <button type="button" id="deleteBtn" class="btn btn-danger" onclick="deletePerson()" style="display: none;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –û–°–¢–ê–õ–¨–ù–´–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    <div id="galleryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</h2>
                <button class="btn btn-secondary close-btn" onclick="closeModal('galleryModal')">‚úï</button>
            </div>
            <div id="galleryGrid" class="gallery-grid"></div>
        </div>
    </div>

    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <button class="btn btn-secondary close-btn" onclick="closeModal('statsModal')">‚úï</button>
            </div>
            <div id="statsContent" class="stats-grid"></div>
        </div>
    </div>

    <div id="timelineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÖ –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞</h2>
                <button class="btn btn-secondary close-btn" onclick="closeModal('timelineModal')">‚úï</button>
            </div>
            <div id="timelineContent" class="timeline"></div>
        </div>
    </div>

    <div id="mapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üó∫Ô∏è –ö–∞—Ä—Ç–∞ –º–µ—Å—Ç —Ä–æ–∂–¥–µ–Ω–∏—è</h2>
                <button class="btn btn-secondary close-btn" onclick="closeModal('mapModal')">‚úï</button>
            </div>
            <div id="mapContent" class="map-content"></div>
        </div>
    </div>

    <!-- –°–ö–†–´–¢–´–ï INPUT –î–õ–Ø –ò–ú–ü–û–†–¢–ê -->
    <input type="file" id="importInput" accept=".json" style="display: none;">
    <input type="file" id="excelInput" accept=".xlsx,.xls" style="display: none;">

    <script src="app.js"></script>
</body>
</html>
